"use strict";(function(){function n(n,t){var i=this;i.name="Användare";i.subject="";i.message="";i.messages=[];i.chatHub=null;i.rooms=[];i.chatHub=$.connection.chatHub;i.isInChat=!1;i.chatHub.client.broadcastMessage=function(t,r){var u=t+" säger: "+r;i.messages.push(u);n.$apply()};i.chatHub.client.broadcastRooms=function(t){for(var r=0;r<t.length;r++)i.rooms.indexOf(t[r])===-1&&i.rooms.push(t[r]);n.$apply()};$.connection.hub.start().done(function(){i.chatHub.server.getAllRooms();t(function(){i.chatHub.server.getAllRooms()},5e3);i.disconnect=function(){i.chatHub.server.removeRoom(i.subject);i.rooms=[];i.chatHub.server.getAllRooms();i.isInChat=!1};i.joinRoomFromList=function(n){i.subject=n;i.createRoom()};i.createRoom=function(){i.chatHub.server.createRoom(i.subject,i.name);i.messages=[];i.messages.push("Vänta på att en administratör ska ansluta innan du skriver...");i.isInChat=!0};i.newMessage=function(){i.chatHub.server.sendMessage(i.name,i.message,i.subject);i.message=""}})}angular.module("app.components.chat",[]).controller("ChatIndexController",n);n.$inject=["$scope","$interval"]})(),function(){function n(n){var t=this;t.showAll=!1;t.toggleShowAll=function(){t.showAll=!t.showAll};n.getTrips().then(function(n){console.log(n.data);t.trips=n.data});n.getLastTrip().then(function(n){console.log(n.data);t.lastTrip=n.data});n.getOnGoing().then(function(n){console.log(n.data);n.data==="No Trip"?(t.onGoingTrip=null,t.isTrip=!1):(t.onGoingTrip=n.data,t.isTrip=!0)})}function t(n,t){var i=this,r=t.location.href,u=r.substr(r.lastIndexOf("/")+1);i.showAll=!1;i.toggleShowAll=function(){i.showAll=!i.showAll};n.editOnGoing(u).then(function(n){i.details=n.data});i.edit=function(){var r=i.trip,u=i.details;r.Id=u.Id;r.Vehicle=u.Vehicle;r.DateTime=u.DateTime;r.StartMilage=u.StartMilage;r.StartAddress=u.StartAddress;r.ArrivalAddress=u.ArrivalAddress;r.Errand=u.Errand;r.Notes=u.Notes;n.register(r).then(function(n){n.data==="success"?(console.log("Trip updated..."),t.location.href="#!/trips"):console.log("Not authorized")})["catch"](function(n){console.log(n)})}}function i(n,t,i,r){var u=this;u.vehicles=function(){t.getVehicles().then(function(n){console.log(n);console.log(n.data);n.data.sort(function(n,t){return t.IsDefault-n.IsDefault});var t=n.data.filter(function(n){return n.IsActive==!0});u.vehicles=t;u.favorite=t[0]})};u.update=function(){u.favorite.Id=u.trip.Vehicle.Id};u.getLocation=function(){function n(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t,Error):console.log("No support for geolocation!")}function t(n){console.log(n);var i=new google.maps.Geocoder,t=n.coords,f={lat:parseFloat(t.latitude),lng:parseFloat(t.longitude)};i.geocode({location:f},function(n,t){if(t==google.maps.GeocoderStatus.OK)if(n[0]){var i=n[0].formatted_address;u.trip.StartAddress=i;r.$apply();console.log(i)}else console.log("No match!");else console.log("Error")})}n()};u.register=function(){n.register(u.trip).then(function(n){n.data==="error"&&alert("Startmätarställning måste vara lägre än föregående resa.");n.data==="success"?(console.log("Trip saved..."),i.location.href="#!/trips/"):console.log("Not authorized")})["catch"](function(n){console.log(n)})}}function r(n,t){var i=this;i.vehicles=function(){t.getVehicles().then(function(n){i.vehicles=n.data})};i.pdfReport=function(){n.pdfReport(i.queryObj).then(function(n){i.report=n.data})["catch"](function(n){console.log(n)})}}function u(n,t,i,r){var u=this;u.vehicles=function(){t.getVehicles().then(function(n){console.log(n.data);u.vehicles=n.data})};u.chart=function(){n.report(u.queryObj).then(function(n){u.report=n.data;r.labels=["0-20 km","21-50 km","51-200 km"];r.data=[u.report.ZeroToTwenty,u.report.TwentyOneToFifty,u.report.FiftyOneToTwoHundred]})["catch"](function(n){console.log(n)})}}angular.module("app.components.trip",[]).controller("TripIndexController",n).controller("TripRegisterController",i).controller("TripPDFReportController",r).controller("TripReportController",u).controller("TripDetailsController",t);n.$inject=["tripService","$window"];t.$inject=["tripService","$window","$scope"];i.$inject=["tripService","vehicleService","$window","$scope"];r.$inject=["tripService","vehicleService","$window"];u.$inject=["tripService","vehicleService","$window","$scope"]}(),function(){function n(n){var t="http://localhost:33355/api/trips/";this.getTrips=function(){return n({method:"GET",url:t})};this.getLastTrip=function(){return n({method:"GET",url:t+"last"})};this.getOnGoing=function(){return n({method:"GET",url:t+"ongoing"})};this.editOnGoing=function(i){return console.log(i),n({method:"GET",url:t+"ongoing/"+i})};this.register=function(i){return console.log(i),n({method:"POST",url:t+"register",data:i})};this.report=function(i){return console.log(i),n({method:"POST",url:t+"report",data:i})};this.pdfReport=function(i){return console.log(i),n({method:"POST",url:t+"pdfreport",data:i})}}angular.module("app.components.trip.services",[]).service("tripService",n);n.$inject=["$http"]}(),function(){function n(n){var t=this;n.getVehicles().then(function(n){console.log(n.data);t.vehicles=n.data})["catch"](function(n){console.log(n)})}function t(n,t){var i=this;i.register=function(){n.register(i.vehicle).then(function(n){n.data==="success"&&(console.log("Vehicle saved..."),t.location.href="#!/vehicles")})["catch"](function(n){console.log(n)})}}function i(n,t){var i=this,r=t.location.href,u=r.substr(r.lastIndexOf("/")+1);i.showAll=!1;i.toggleShowAll=function(){i.showAll=!i.showAll};console.log(u);n.editVehicle(u).then(function(n){i.details=n.data});i.edit=function(){var r=i.vehicle,u=i.details;r.Id=u.Id;r.RegistrationNumber=u.RegistrationNumber;n.register(r).then(function(n){n.data==="success"?(console.log("Vehicle updated..."),console.log("#!/vehicles/details/"+u.Id),t.location.href="#!/vehicles"):console.log("Not authorized")})["catch"](function(n){console.log(n)})}}function r(n,t){var u=this,i=t.location.href,r=i.substr(i.lastIndexOf("/")+1);console.log(r);n.removeVehicle(r).then(function(n){n.data==="success"?(console.log("Vehicle updated..."),t.location.href="#!/vehicles"):console.log("Not authorized")})}angular.module("app.components.vehicle",[]).controller("VehicleIndexController",n).controller("VehicleRegisterController",t).controller("VehicleDetailsController",i).controller("VehicleDeleteController",r);n.$inject=["vehicleService"];t.$inject=["vehicleService","$window"];i.$inject=["vehicleService","$window","$scope"];r.$inject=["vehicleService","$window","$scope"]}(),function(){function n(n){var t="http://localhost:33355/api/vehicles/";this.getVehicles=function(){return n({method:"GET",url:t})};this.details=function(i){return n({method:"GET",url:t+"details/"+i})};this.editVehicle=function(i){return n({method:"GET",url:t+"details/"+i})};this.removeVehicle=function(i){return n({method:"GET",url:t+"delete/"+i})};this.register=function(i){return console.log(i),n({method:"POST",url:t+"register",data:i})}}angular.module("app.components.vehicle.services",[]).service("vehicleService",n);n.$inject=["$http"]}();